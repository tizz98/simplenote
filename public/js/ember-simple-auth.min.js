!function(t){Ember.libraries.register("Ember Simple Auth","0.8.0-beta.2");var e,i;!function(){var t={},n={};e=function(e,i,n){t[e]={deps:i,callback:n}},i=function(e){function r(t){if("."!==t.charAt(0))return t;for(var i=t.split("/"),n=e.split("/").slice(0,-1),r=0,s=i.length;s>r;r++){var o=i[r];if(".."===o)n.pop();else{if("."===o)continue;n.push(o)}}return n.join("/")}if(n.hasOwnProperty(e))return n[e];if(n[e]={},!t[e])throw new Error("Could not find module "+e);for(var s,o=t[e],a=o.deps,u=o.callback,c=[],l=0,h=a.length;h>l;l++)c.push("exports"===a[l]?s={}:i(r(a[l])));var f=u.apply(this,c);return n[e]=s||f},i.registry=t}(),e("simple-auth/authenticators/base",["exports"],function(t){"use strict";t["default"]=Ember.Object.extend(Ember.Evented,{restore:function(){return Ember.RSVP.reject()},authenticate:function(){return Ember.RSVP.reject()},invalidate:function(){return Ember.RSVP.resolve()}})}),e("simple-auth/authorizers/base",["exports"],function(t){"use strict";t["default"]=Ember.Object.extend({session:null,authorize:function(){}})}),e("simple-auth/configuration",["simple-auth/utils/load-config","exports"],function(t,e){"use strict";var i=t["default"],n={authenticationRoute:"login",routeAfterAuthentication:"index",routeIfAlreadyAuthenticated:"index",sessionPropertyName:"session",authorizer:null,session:"simple-auth-session:main",store:"simple-auth-session-store:local-storage",localStorageKey:"ember_simple_auth:session",crossOriginWhitelist:[],applicationRootUrl:null};e["default"]={authenticationRoute:n.authenticationRoute,routeAfterAuthentication:n.routeAfterAuthentication,routeIfAlreadyAuthenticated:n.routeIfAlreadyAuthenticated,sessionPropertyName:n.sessionPropertyName,authorizer:n.authorizer,session:n.session,store:n.store,localStorageKey:n.localStorageKey,crossOriginWhitelist:n.crossOriginWhitelist,applicationRootUrl:n.applicationRootUrl,load:i(n,function(t){this.applicationRootUrl=t.lookup("router:main").get("rootURL")||"/"})}}),e("simple-auth/ember",["./initializer"],function(t){"use strict";var e=t["default"];Ember.onLoad("Ember.Application",function(t){t.initializer(e)})}),e("simple-auth/initializer",["./configuration","./utils/get-global-config","./setup","exports"],function(t,e,i,n){"use strict";var r=t["default"],s=e["default"],o=i["default"];n["default"]={name:"simple-auth",initialize:function(t,e){var i=s("simple-auth");r.load(t,i),o(t,e)}}}),e("simple-auth/mixins/application-route-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"],n=!1;e["default"]=Ember.Mixin.create({activate:function(){n=!0,this._super()},beforeModel:function(t){if(this._super(t),!this.get("_authEventListenersAssigned")){this.set("_authEventListenersAssigned",!0);var e=this;Ember.A(["sessionAuthenticationSucceeded","sessionAuthenticationFailed","sessionInvalidationSucceeded","sessionInvalidationFailed","authorizationFailed"]).forEach(function(r){e.get(i.sessionPropertyName).on(r,function(){Array.prototype.unshift.call(arguments,r);var i=n?e:t;i.send.apply(i,arguments)})})}},actions:{sessionRequiresAuthentication:function(){this.transitionTo(i.authenticationRoute)},authenticateSession:function(){Ember.deprecate("The authenticateSession action is deprecated. Use sessionRequiresAuthentication instead."),this.send("sessionRequiresAuthentication")},sessionAuthenticationSucceeded:function(){var t=this.get(i.sessionPropertyName).get("attemptedTransition");t?(t.retry(),this.get(i.sessionPropertyName).set("attemptedTransition",null)):this.transitionTo(i.routeAfterAuthentication)},sessionAuthenticationFailed:function(){},invalidateSession:function(){Ember.deprecate("The invalidateSession action is deprecated. Use the session's invalidate method directly instead."),this.get(i.sessionPropertyName).invalidate()},sessionInvalidationSucceeded:function(){Ember.testing||window.location.replace(i.applicationRootUrl)},sessionInvalidationFailed:function(){},authorizationFailed:function(){this.get(i.sessionPropertyName).get("isAuthenticated")&&this.get(i.sessionPropertyName).invalidate()}}})}),e("simple-auth/mixins/authenticated-route-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=Ember.Mixin.create({beforeModel:function(t){var e=this._super(t);return this.get(i.sessionPropertyName).get("isAuthenticated")||(t.abort(),this.get(i.sessionPropertyName).set("attemptedTransition",t),Ember.assert("The route configured as Configuration.authenticationRoute cannot implement the AuthenticatedRouteMixin mixin as that leads to an infinite transitioning loop!",this.get("routeName")!==i.authenticationRoute),t.send("sessionRequiresAuthentication")),e}})}),e("simple-auth/mixins/authentication-controller-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=Ember.Mixin.create({authenticator:null,actions:{authenticate:function(t){Ember.deprecate("The AuthenticationControllerMixin is deprecated. Use the session's authenticate method directly instead.");var e=this.get("authenticator");return Ember.assert("AuthenticationControllerMixin/LoginControllerMixin require the authenticator property to be set on the controller!",!Ember.isEmpty(e)),this.get(i.sessionPropertyName).authenticate(e,t)}}})}),e("simple-auth/mixins/login-controller-mixin",["./../configuration","./authentication-controller-mixin","exports"],function(t,e,i){"use strict";var n=(t["default"],e["default"]);i["default"]=Ember.Mixin.create(n,{actions:{authenticate:function(){Ember.deprecate("The LoginControllerMixin is deprecated. Use the session's authenticate method directly instead.");var t=this.getProperties("identification","password");return this.set("password",null),this._super(t)}}})}),e("simple-auth/mixins/unauthenticated-route-mixin",["./../configuration","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=Ember.Mixin.create({beforeModel:function(t){this.get(i.sessionPropertyName).get("isAuthenticated")&&(t.abort(),Ember.assert("The route configured as Configuration.routeIfAlreadyAuthenticated cannot implement the UnauthenticatedRouteMixin mixin as that leads to an infinite transitioning loop!",this.get("routeName")!==i.routeIfAlreadyAuthenticated),this.transitionTo(i.routeIfAlreadyAuthenticated))}})}),e("simple-auth/session",["exports"],function(t){"use strict";t["default"]=Ember.ObjectProxy.extend(Ember.Evented,{authenticator:null,store:null,container:null,isAuthenticated:!1,attemptedTransition:null,content:{secure:{}},authenticate:function(){var t=Array.prototype.slice.call(arguments),e=t.shift();Ember.assert('Session#authenticate requires the authenticator factory to be specified, was "'+e+'"!',!Ember.isEmpty(e));var i=this,n=this.container.lookup(e);return Ember.assert('No authenticator for factory "'+e+'" could be found!',!Ember.isNone(n)),new Ember.RSVP.Promise(function(r,s){n.authenticate.apply(n,t).then(function(t){i.setup(e,t,!0),r()},function(t){i.clear(),i.trigger("sessionAuthenticationFailed",t),s(t)})})},invalidate:function(){Ember.assert("Session#invalidate requires the session to be authenticated!",this.get("isAuthenticated"));var t=this;return new Ember.RSVP.Promise(function(e,i){var n=t.container.lookup(t.authenticator);n.invalidate(t.content.secure).then(function(){n.off("sessionDataUpdated"),t.clear(!0),e()},function(e){t.trigger("sessionInvalidationFailed",e),i(e)})})},restore:function(){var t=this;return new Ember.RSVP.Promise(function(e,i){var n=t.store.restore(),r=(n.secure||{}).authenticator;r?(delete n.secure.authenticator,t.container.lookup(r).restore(n.secure).then(function(i){t.setup(r,i),e()},function(){t.clear(),i()})):(t.clear(),i())})},setup:function(t,e,i){i=!!i&&!this.get("isAuthenticated"),this.beginPropertyChanges(),this.setProperties({isAuthenticated:!0,authenticator:t}),Ember.set(this.content,"secure",e),this.bindToAuthenticatorEvents(),this.updateStore(),this.endPropertyChanges(),i&&this.trigger("sessionAuthenticationSucceeded")},clear:function(t){t=!!t&&this.get("isAuthenticated"),this.beginPropertyChanges(),this.setProperties({isAuthenticated:!1,authenticator:null}),Ember.set(this.content,"secure",{}),this.updateStore(),this.endPropertyChanges(),t&&this.trigger("sessionInvalidationSucceeded")},setUnknownProperty:function(t,e){Ember.assert('"secure" is a reserved key used by Ember Simple Auth!',"secure"!==t);var i=this._super(t,e);return this.updateStore(),i},updateStore:function(){var t=this.content;Ember.isEmpty(this.authenticator)||Ember.set(t,"secure",Ember.merge({authenticator:this.authenticator},t.secure||{})),this.store.persist(t)},bindToAuthenticatorEvents:function(){var t=this,e=this.container.lookup(this.authenticator);e.off("sessionDataUpdated"),e.off("sessionDataInvalidated"),e.on("sessionDataUpdated",function(e){t.setup(t.authenticator,e)}),e.on("sessionDataInvalidated",function(){t.clear(!0)})},bindToStoreEvents:Ember.observer("store",function(){var t=this;this.store.on("sessionDataUpdated",function(e){var i=(e.secure||{}).authenticator;i?(delete e.secure.authenticator,t.container.lookup(i).restore(e.secure).then(function(n){t.set("content",e),t.setup(i,n,!0)},function(){t.set("content",e),t.clear(!0)})):(t.set("content",e),t.clear(!0))})})})}),e("simple-auth/setup",["./configuration","./session","./stores/local-storage","./stores/ephemeral","exports"],function(t,e,i,n,r){"use strict";function s(t){if("*"===t)return t;if(t=t.replace("*",g),"string"===Ember.typeOf(t)){var e=document.createElement("a");e.href=t,e.href=e.href,t=e}var i=t.port;return Ember.isEmpty(i)&&(i="http:"===t.protocol?"80":"https:"===t.protocol?"443":""),t.protocol+"//"+t.hostname+(""!==i?":"+i:"")}function o(t){return function(e){if(e.indexOf(g)>-1){var i=new RegExp(e.replace(g,".+"));return t.match(i)}return e.indexOf(t)>-1}}function a(t){if(t.crossDomain===!1||h.indexOf("*")>-1)return!0;var e=b[t.url]=b[t.url]||s(t.url);return Ember.A(h).any(o(e))}function u(t){t.register("simple-auth-session-store:local-storage",p),t.register("simple-auth-session-store:ephemeral",m),t.register("simple-auth-session:main",d)}function c(t,e,i){a(t)&&(i.__simple_auth_authorized__=!0,c.authorizer.authorize(i,t))}function l(t,e){e.__simple_auth_authorized__&&401===e.status&&l.session.trigger("authorizationFailed")}var h,f=t["default"],d=e["default"],p=i["default"],m=n["default"],g="_wildcard_token_",b={},E=!1;r["default"]=function(t,e){e.deferReadiness(),u(e);var i=t.lookup(f.store),n=t.lookup(f.session);if(n.set("store",i),Ember.A(["controller","route","component"]).forEach(function(t){e.inject(t,f.sessionPropertyName,f.session)}),h=Ember.A(f.crossOriginWhitelist).map(function(t){return s(t)}),Ember.isEmpty(f.authorizer))Ember.Logger.info("No authorizer was configured for Ember Simple Auth - specify one if backend requests need to be authorized.");else{var r=t.lookup(f.authorizer);Ember.assert('The configured authorizer "'+f.authorizer+'" could not be found in the container!',!Ember.isEmpty(r)),r.set("session",n),c.authorizer=r,l.session=n,E||(Ember.$.ajaxPrefilter("+*",c),Ember.$(document).ajaxError(l),E=!0)}var o=function(){e.advanceReadiness()};n.restore().then(o,o)}}),e("simple-auth/stores/base",["../utils/objects-are-equal","exports"],function(t,e){"use strict";t["default"];e["default"]=Ember.Object.extend(Ember.Evented,{persist:function(){},restore:function(){return{}},clear:function(){}})}),e("simple-auth/stores/ephemeral",["./base","exports"],function(t,e){"use strict";var i=t["default"];e["default"]=i.extend({init:function(){this.clear()},persist:function(t){this._data=JSON.stringify(t||{})},restore:function(){return JSON.parse(this._data)||{}},clear:function(){delete this._data,this._data="{}"}})}),e("simple-auth/stores/local-storage",["./base","../utils/objects-are-equal","../configuration","exports"],function(t,e,i,n){"use strict";var r=t["default"],s=e["default"],o=i["default"];n["default"]=r.extend({key:"ember_simple_auth:session",init:function(){this.key=o.localStorageKey,this.bindToStorageEvents()},persist:function(t){t=JSON.stringify(t||{}),localStorage.setItem(this.key,t),this._lastData=this.restore()},restore:function(){var t=localStorage.getItem(this.key);return JSON.parse(t)||{}},clear:function(){localStorage.removeItem(this.key),this._lastData={}},bindToStorageEvents:function(){var t=this;Ember.$(window).bind("storage",function(){var e=t.restore();s(e,t._lastData)||(t._lastData=e,t.trigger("sessionDataUpdated",e))})}})}),e("simple-auth/utils/get-global-config",["exports"],function(t){"use strict";var e="undefined"!=typeof window?window:{};t["default"]=function(t){return Ember.get(e,"ENV."+t)||{}}}),e("simple-auth/utils/load-config",["exports"],function(t){"use strict";t["default"]=function(t,e){return function(i,n){var r=Ember.Object.create(n);for(var s in this)this.hasOwnProperty(s)&&"function"!==Ember.typeOf(this[s])&&(this[s]=r.getWithDefault(s,t[s]));e&&e.apply(this,[i,n])}}}),e("simple-auth/utils/objects-are-equal",["exports"],function(t){"use strict";t["default"]=function(t,e){function i(t,e){var n;if(isNaN(t)&&isNaN(e)&&"number"==typeof t&&"number"==typeof e)return!0;if(t===e)return!0;if(!(t instanceof Object&&e instanceof Object))return!1;for(n in e){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(typeof e[n]!=typeof t[n])return!1}for(n in t){if(e.hasOwnProperty(n)!==t.hasOwnProperty(n))return!1;if(typeof e[n]!=typeof t[n])return!1;switch(typeof t[n]){case"object":if(!i(t[n],e[n]))return!1;break;default:if(t[n]!==e[n])return!1}}return!0}return i(t,e)}});var n=(i("simple-auth/initializer")["default"],i("simple-auth/configuration")["default"]),r=i("simple-auth/session")["default"],s=i("simple-auth/authenticators/base")["default"],o=i("simple-auth/authorizers/base")["default"],a=i("simple-auth/stores/base")["default"],u=i("simple-auth/stores/local-storage")["default"],c=i("simple-auth/stores/ephemeral")["default"],l=i("simple-auth/utils/objects-are-equal")["default"],h=i("simple-auth/utils/get-global-config")["default"],f=i("simple-auth/utils/load-config")["default"],d=i("simple-auth/mixins/application-route-mixin")["default"],p=i("simple-auth/mixins/authenticated-route-mixin")["default"],m=i("simple-auth/mixins/authentication-controller-mixin")["default"],g=i("simple-auth/mixins/login-controller-mixin")["default"],b=i("simple-auth/mixins/unauthenticated-route-mixin")["default"];t.SimpleAuth={Configuration:n,Session:r,Authenticators:{Base:s},Authorizers:{Base:o},Stores:{Base:a,LocalStorage:u,Ephemeral:c},Utils:{objectsAreEqual:l,getGlobalConfig:h,loadConfig:f},ApplicationRouteMixin:d,AuthenticatedRouteMixin:p,AuthenticationControllerMixin:m,LoginControllerMixin:g,UnauthenticatedRouteMixin:b},i("simple-auth/ember")}("undefined"!=typeof global?global:window);